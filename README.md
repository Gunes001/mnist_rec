# MNIST Recognition with PyTorch - 技术文档与使用说明

## 概述

本项目使用PyTorch框架实现了一个简单的全连接神经网络，用于识别MNIST手写数字数据集。MNIST数据集包含60,000个训练样本和10,000个测试样本，每个样本是一个28x28的灰度图像，表示0到9之间的手写数字。本项目分为两个主要部分：模型训练和模型加载与预测。

## 文件结构

- `Training.py`: 用于训练模型并将训练好的模型保存到磁盘。
- `Loadmodel.py`: 用于加载训练好的模型并对测试数据进行预测。

## 依赖项

- Python 3.x
- PyTorch
- Pandas

## 安装与配置

1. **安装Python**: 确保已安装Python 3.x版本。
2. **安装依赖库**:
   ```bash
   pip install torch pandas
   ```
3. **下载MNIST数据集**: 本项目使用CSV格式的MNIST数据集。可以从以下链接下载：
   - [MNIST训练集](https://www.kaggle.com/oddrationale/mnist-in-csv)
   - [MNIST测试集](https://www.kaggle.com/oddrationale/mnist-in-csv)

   将下载的CSV文件放置在项目目录下，并分别命名为`mnist_train.csv`和`mnist_test.csv`。

## 使用说明

### 1. 训练模型

运行`Training.py`脚本以训练模型。该脚本将执行以下操作：

- 加载MNIST训练数据集。
- 构建一个包含两个隐藏层的全连接神经网络。
- 使用Adam优化器和交叉熵损失函数进行训练。
- 在训练过程中输出损失值和训练准确率。
- 训练完成后，将模型保存为`model.pth`文件。

```bash
python Training.py
```

**输出示例**:
```
Train 1, Loss: 2.3025851249694824, accuracy: 0.1125
Train 2, Loss: 2.3025851249694824, accuracy: 0.1125
...
Train 100, Loss: 0.123456789, accuracy: 0.9875
Test Loss: 0.123456789, accuracy: 0.9850
训练完成
```

### 2. 加载模型并进行预测

运行`Loadmodel.py`脚本以加载训练好的模型并对测试数据进行预测。该脚本将执行以下操作：

- 加载保存的模型`model.pth`。
- 加载MNIST测试数据集。
- 使用模型对测试数据进行预测。
- 输出真实标签和预测结果。

```bash
python Loadmodel.py
```

**输出示例**:
```
真实标签: tensor([7, 2, 1, ..., 4, 5, 6])
预测结果: tensor([7, 2, 1, ..., 4, 5, 6])
```

## 模型结构

模型是一个包含两个隐藏层的全连接神经网络，结构如下：

1. **输入层**: 784个输入节点（对应28x28的像素图像）。
2. **隐藏层1**: 444个节点，使用ReLU激活函数。
3. **隐藏层2**: 512个节点，使用ReLU激活函数。
4. **输出层**: 10个节点（对应0到9的数字），使用Softmax激活函数。

## 训练参数

- **优化器**: Adam
- **学习率**: 0.0001
- **损失函数**: 交叉熵损失函数
- **训练轮数**: 100

## 注意事项

1. **硬件要求**: 训练过程可能需要一定的计算资源，建议使用GPU进行训练。本项目默认使用MPS（Mac上的GPU加速）或CPU。
2. **数据集路径**: 确保`mnist_train.csv`和`mnist_test.csv`文件位于项目目录下。
3. **模型保存**: 训练完成后，模型将保存为`model.pth`文件。确保在加载模型时该文件存在。

## 结论

本项目展示了如何使用PyTorch构建、训练和评估一个简单的全连接神经网络，用于MNIST手写数字识别。通过本项目的代码，用户可以进一步探索深度学习模型的训练和预测过程，并根据需要进行修改和优化。
